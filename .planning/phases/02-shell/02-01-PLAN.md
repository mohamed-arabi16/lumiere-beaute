---
phase: 02-shell
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/providers/AppProviders.tsx
  - src/router.tsx
  - src/App.tsx
  - src/animations/variants.ts
autonomous: true
requirements:
  - FNDTN-06

must_haves:
  truths:
    - "BrowserRouter wraps all providers so useNavigate and useLocation work anywhere in the tree"
    - "Five named routes (/, /services, /academy, /about, /contact) are declared and functional"
    - "App.tsx renders the router, not ThemeTestComponent"
    - "RTL-aware page transition variants (enter from correct side, exit to correct side) are defined and exported"
  artifacts:
    - path: "src/providers/AppProviders.tsx"
      provides: "BrowserRouter as outermost wrapper around ThemeProvider + I18nextProvider"
      contains: "BrowserRouter"
    - path: "src/router.tsx"
      provides: "AppRouter component with 5 routes under RootLayout parent route"
      exports: ["AppRouter"]
    - path: "src/App.tsx"
      provides: "Root component rendering AppRouter"
      contains: "AppRouter"
    - path: "src/animations/variants.ts"
      provides: "RTL-aware pageTransitionVariants and pageFadeVariants"
      exports: ["pageTransitionVariants", "pageFadeVariants", "TextDir"]
  key_links:
    - from: "src/providers/AppProviders.tsx"
      to: "BrowserRouter"
      via: "import from react-router-dom"
      pattern: "BrowserRouter"
    - from: "src/router.tsx"
      to: "src/layouts/RootLayout"
      via: "Route element prop"
      pattern: "element=\\{<RootLayout"
    - from: "src/animations/variants.ts"
      to: "pageTransitionVariants"
      via: "variant function with custom prop"
      pattern: "initial.*dir.*rtl"
---

<objective>
Wire up the routing infrastructure and define the shared animation variants so all subsequent phase work can build on a stable foundation.

Purpose: Phase 1 intentionally deferred BrowserRouter. This plan adds it as the outermost provider, declares the five application routes, updates App.tsx to render the router, and creates the RTL-aware Framer Motion variants that every page transition will use.
Output: BrowserRouter-wrapped provider chain, AppRouter with 5 routes, RTL-aware animation variants module.
</objective>

<execution_context>
@/Users/mohamedkhair/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mohamedkhair/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-shell/2-RESEARCH.md
@src/providers/AppProviders.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add BrowserRouter to AppProviders and update App.tsx</name>
  <files>src/providers/AppProviders.tsx, src/App.tsx, src/router.tsx</files>
  <action>
    Update src/providers/AppProviders.tsx:
    - Import BrowserRouter from 'react-router-dom'
    - Wrap the existing ThemeProvider > I18nextProvider chain with BrowserRouter as the OUTERMOST wrapper
    - Final nesting order must be: BrowserRouter > ThemeProvider > I18nextProvider > {children}
    - This matches the research recommendation: BrowserRouter wraps everything so hooks like useNavigate are available even inside ThemeProvider if ever needed

    Create src/router.tsx:
    - Import Routes, Route from 'react-router-dom'
    - Import RootLayout from './layouts/RootLayout' (file does not exist yet — will be created in Plan 03; use a temporary stub: export function RootLayout() { return <div>shell</div>; })
    - Actually: do NOT import RootLayout here yet. Instead create a temporary AppRouter that renders a simple placeholder and note it will be updated in Plan 03.
    - CORRECTION: Create router.tsx with the FINAL route structure but import RootLayout from './layouts/RootLayout' — Plan 03 will create that file. TypeScript will error until Plan 03 completes. That is acceptable because plans execute sequentially in this phase (Plan 03 depends on Plan 01).
    - Final router.tsx structure:
      ```typescript
      import { Routes, Route } from 'react-router-dom';
      import { RootLayout } from './layouts/RootLayout';
      import { HomePage } from './pages/HomePage';
      import { ServicesPage } from './pages/ServicesPage';
      import { AcademyPage } from './pages/AcademyPage';
      import { AboutPage } from './pages/AboutPage';
      import { ContactPage } from './pages/ContactPage';

      export function AppRouter() {
        return (
          <Routes>
            <Route element={<RootLayout />}>
              <Route index element={<HomePage />} />
              <Route path="services" element={<ServicesPage />} />
              <Route path="academy" element={<AcademyPage />} />
              <Route path="about" element={<AboutPage />} />
              <Route path="contact" element={<ContactPage />} />
            </Route>
          </Routes>
        );
      }
      ```
    - Since page and layout files do not exist yet (Plans 02 and 03 create them), create stub files for each import target so TypeScript compiles:
      - src/layouts/RootLayout.tsx: export function RootLayout() { return <div>layout stub</div>; }
      - src/pages/HomePage.tsx: export function HomePage() { return <div>Home</div>; }
      - src/pages/ServicesPage.tsx: export function ServicesPage() { return <div>Services</div>; }
      - src/pages/AcademyPage.tsx: export function AcademyPage() { return <div>Academy</div>; }
      - src/pages/AboutPage.tsx: export function AboutPage() { return <div>About</div>; }
      - src/pages/ContactPage.tsx: export function ContactPage() { return <div>Contact</div>; }

    Update src/App.tsx:
    - Remove ThemeTestComponent import
    - Import AppRouter from './router'
    - Return <AppRouter />
    - ThemeTestComponent.tsx file stays on disk (do not delete), just not imported

    CRITICAL DECISIONS from STATE.md:
    - BrowserRouter intentionally omitted from AppProviders in Phase 1 — [01-03] decision — NOW add it
    - ThemeTestComponent is a temporary Phase 1 verification scaffold — [01-04] decision — replace in App.tsx
  </action>
  <verify>Run `npx tsc --noEmit` from project root — zero TypeScript errors. Run `npm run dev` — browser opens without console errors, white page renders (stub layout).</verify>
  <done>TypeScript compiles clean. Dev server starts. BrowserRouter wraps the provider tree. router.tsx exports AppRouter with 5 routes. App.tsx renders AppRouter instead of ThemeTestComponent.</done>
</task>

<task type="auto">
  <name>Task 2: Create RTL-aware animation variants module</name>
  <files>src/animations/variants.ts</files>
  <action>
    Create src/animations/variants.ts with two variant sets:

    1. pageTransitionVariants — RTL-aware slide + fade for cinematic page transitions:
       - Type: export type TextDir = 'ltr' | 'rtl';
       - initial: function(dir: TextDir) returning { opacity: 0, x: dir === 'rtl' ? '-5vw' : '5vw' }
       - animate: { opacity: 1, x: 0, transition: { duration: 0.45, ease: [0.22, 1, 0.36, 1] } }
       - exit: function(dir: TextDir) returning { opacity: 0, x: dir === 'rtl' ? '5vw' : '-5vw', transition: { duration: 0.3, ease: [0.22, 1, 0.36, 1] } }
       - The [0.22, 1, 0.36, 1] cubic-bezier = fast-decelerate luxury feel (editorial standard)

    2. pageFadeVariants — opacity-only for pages where slide is inappropriate:
       - initial: { opacity: 0 }
       - animate: { opacity: 1, transition: { duration: 0.35, ease: 'easeOut' } }
       - exit: { opacity: 0, transition: { duration: 0.25, ease: 'easeIn' } }

    IMPORTANT — variant function syntax for custom prop (from research):
    The initial and exit must be FUNCTIONS receiving dir as parameter (not plain objects).
    AnimatePresence passes `custom` down to exiting component — this is how RTL exit direction works
    even after language may have changed.

    Usage pattern (for Plan 03 page stubs to follow):
    ```typescript
    <motion.div
      custom={dir}           // dir from useDirection()
      variants={pageTransitionVariants}
      initial="initial"
      animate="animate"
      exit="exit"
      className="min-h-screen"
    >
    ```

    Do NOT hardcode x values as percentages (e.g. '100%') — use viewport units ('5vw') for
    a subtle cinematic drift rather than a full-screen slide-in, which is more luxury-appropriate.
  </action>
  <verify>Run `npx tsc --noEmit` — TypeScript accepts the variant function signatures without errors.</verify>
  <done>src/animations/variants.ts exports TextDir, pageTransitionVariants, pageFadeVariants. TypeScript compiles clean. Variant functions accept dir parameter and return correct x values per RTL state.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- `npm run dev` starts without console errors
- Browser shows stub layout (no crash)
- src/providers/AppProviders.tsx contains BrowserRouter as outermost wrapper
- src/router.tsx exports AppRouter with 5 Route declarations
- src/App.tsx imports AppRouter, not ThemeTestComponent
- src/animations/variants.ts exports pageTransitionVariants with function-form initial/exit
</verification>

<success_criteria>
BrowserRouter is live. Five routes are declared. App.tsx renders the router. RTL-aware animation variants are ready for page stubs to consume. TypeScript compiles clean across all new and modified files.
</success_criteria>

<output>
After completion, create `.planning/phases/02-shell/02-01-SUMMARY.md`
</output>
