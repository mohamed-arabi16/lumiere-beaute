---
phase: 03-shared-components
plan: "03"
type: execute
wave: 2
depends_on:
  - "03-01"
files_modified:
  - src/components/animations/TypewriterText.tsx
  - src/components/ui/Button.tsx
  - src/components/ui/Card.tsx
  - src/components/ui/Typography.tsx
autonomous: true
requirements:
  - SC3-2
  - SC3-4

must_haves:
  truths:
    - "TypewriterText animates each character into view one at a time at 40ms per character using motion.span stagger"
    - "TypewriterText container has aria-label set to the full text and individual spans have aria-hidden — screen readers read the full phrase, not individual characters"
    - "Button renders correctly with both 'primary' and 'ghost' variants using brand token colors from globals.css"
    - "Card renders with optional gradient placeholder slot using the existing .placeholder-gradient-card class"
    - "Typography renders headings in Cormorant Garamond (via font-display) and body text in Inter (via font-body)"
  artifacts:
    - path: "src/components/animations/TypewriterText.tsx"
      provides: "Character-stagger typewriter effect for hero headline"
      exports: ["TypewriterText"]
      min_lines: 35
    - path: "src/components/ui/Button.tsx"
      provides: "Brand CTA button with primary and ghost variants"
      exports: ["Button"]
    - path: "src/components/ui/Card.tsx"
      provides: "Brand content card with optional gradient placeholder slot"
      exports: ["Card"]
    - path: "src/components/ui/Typography.tsx"
      provides: "Heading and body text wrappers enforcing font tokens"
      exports: ["Heading", "BodyText"]
  key_links:
    - from: "src/components/animations/TypewriterText.tsx"
      to: "MotionConfig in AppProviders"
      via: "inherits reducedMotion handling automatically — no explicit useReducedMotion needed"
      pattern: "animate.*visible"
    - from: "src/components/ui/Button.tsx"
      to: "src/styles/globals.css"
      via: "Tailwind utility classes reference brand tokens (seagrass-*, stormy-teal-*, celadon-*)"
      pattern: "seagrass|stormy-teal|celadon"
---

<objective>
Build TypewriterText (the hero animation) and the three UI primitives (Button, Card, Typography) that page sections will compose throughout Phase 4+.

Purpose: TypewriterText is the centrepiece of the hero section — character-level stagger using motion.span creates the "types itself" effect without any external library. The UI primitives enforce brand token vocabulary so pages never accidentally use off-brand colors.
Output: Four new component files — TypewriterText.tsx, Button.tsx, Card.tsx, Typography.tsx.
</objective>

<execution_context>
@/Users/mohamedkhair/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mohamedkhair/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/styles/globals.css
@.planning/phases/03-shared-components/3-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypewriterText component</name>
  <files>src/components/animations/TypewriterText.tsx</files>
  <action>
    Create `src/components/animations/TypewriterText.tsx`. The `src/components/animations/` directory is created by Plan 02 — this file coexists with FadeInSection.tsx and StaggerContainer.tsx.

    This component splits a string character by character and renders each as a `motion.span` with staggered opacity reveal. The parent uses `animate="visible"` (not `whileInView`) — it fires immediately on mount, which is correct for the hero headline that is always above the fold.

    DO NOT wrap TypewriterText inside FadeInSection. The research is explicit: double-animating the same element conflicts. TypewriterText animates itself.

    Implementation:
    ```tsx
    import { motion } from 'motion/react';
    import type { Variants } from 'motion/react';

    const STAGGER_DELAY = 0.04; // 40ms per character — readable but snappy

    const containerVariants: Variants = {
      hidden: {},
      visible: {
        transition: { staggerChildren: STAGGER_DELAY },
      },
    };

    const charVariants: Variants = {
      hidden: { opacity: 0 },
      visible: {
        opacity: 1,
        transition: { duration: 0 }, // snap-in, pure typewriter feel, no fade
      },
    };

    interface TypewriterTextProps {
      text: string;
      className?: string;
      as?: 'h1' | 'h2' | 'h3' | 'p' | 'span';
    }

    export function TypewriterText({ text, className, as = 'h1' }: TypewriterTextProps) {
      const tagMap = {
        h1: motion.h1,
        h2: motion.h2,
        h3: motion.h3,
        p: motion.p,
        span: motion.span,
      } as const;

      const MotionTag = tagMap[as];

      return (
        &lt;MotionTag
          className={className}
          variants={containerVariants}
          initial="hidden"
          animate="visible"
          aria-label={text}
        &gt;
          {text.split('').map((char, i) => (
            &lt;motion.span
              key={i}
              variants={charVariants}
              aria-hidden="true"
            &gt;
              {char === ' ' ? '\u00A0' : char}
            &lt;/motion.span&gt;
          ))}
        &lt;/MotionTag&gt;
      );
    }
    ```

    The `tagMap` lookup avoids dynamic `motion[Tag]` index-signature TypeScript issues (flagged as low-confidence in research). The explicit map is fully type-safe.

    RTL behavior: Arabic `text.split('')` returns characters in Unicode string order. The containing element inherits `dir="rtl"` from the html element, so browser rendering places characters right-to-left automatically. No JavaScript RTL logic needed in this component.

    Accessibility: `aria-label={text}` on the container lets screen readers announce the full phrase. `aria-hidden="true"` on each span prevents character-by-character announcement.

    prefers-reduced-motion: because MotionConfig(reducedMotion="user") is in AppProviders (Plan 01), the stagger animation automatically skips when the OS setting is active — characters snap in together at their final opacity:1 state. No per-component logic needed.
  </action>
  <verify>Run `npx tsc --noEmit` from /Users/mohamedkhair/Coding/lumiere-beaute — zero TypeScript errors. `grep "aria-label" src/components/animations/TypewriterText.tsx` — found on the container element. `grep "aria-hidden" src/components/animations/TypewriterText.tsx` — found on motion.span. `grep "tagMap" src/components/animations/TypewriterText.tsx` — found.</verify>
  <done>TypewriterText.tsx exists, TypeScript compiles cleanly, aria-label on container and aria-hidden on chars present, tagMap pattern used (no dynamic motion[Tag]).</done>
</task>

<task type="auto">
  <name>Task 2: Create UI primitives — Button, Card, Typography</name>
  <files>src/components/ui/Button.tsx, src/components/ui/Card.tsx, src/components/ui/Typography.tsx</files>
  <action>
    Create the `src/components/ui/` directory and three files. These are thin Tailwind wrappers that enforce brand token vocabulary. They add NO animation — animation wrappers compose around them.

    All classes use ONLY Tailwind logical properties for inline-axis spacing (`ps-`, `pe-`, `ms-`, `me-`) — never physical `pl-`, `pr-`, `ml-`, `mr-`. This is a locked project decision from Phase 1.

    ---

    **src/components/ui/Button.tsx:**
    ```tsx
    interface ButtonProps {
      variant: 'primary' | 'ghost';
      children: React.ReactNode;
      className?: string;
      onClick?: () => void;
      as?: 'button' | 'a';
      href?: string;
      type?: 'button' | 'submit' | 'reset';
      disabled?: boolean;
    }

    export function Button({
      variant,
      children,
      className,
      onClick,
      as: Tag = 'button',
      href,
      type = 'button',
      disabled,
    }: ButtonProps) {
      const base =
        'inline-flex items-center ps-6 pe-6 py-3 font-body text-sm font-medium transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-seagrass-500 rounded-sm';
      const variants = {
        primary:
          'bg-stormy-teal-950 text-celadon-100 hover:bg-deep-ocean-900 dark:bg-seagrass-600 dark:hover:bg-seagrass-500 disabled:opacity-50 disabled:cursor-not-allowed',
        ghost:
          'border border-seagrass-500 text-seagrass-600 hover:bg-seagrass-500/10 dark:text-seagrass-400 dark:border-seagrass-400 disabled:opacity-50 disabled:cursor-not-allowed',
      };
      return (
        &lt;Tag
          href={href}
          type={Tag === 'button' ? type : undefined}
          onClick={onClick}
          disabled={Tag === 'button' ? disabled : undefined}
          className={[base, variants[variant], className].filter(Boolean).join(' ')}
        &gt;
          {children}
        &lt;/Tag&gt;
      );
    }
    ```

    ---

    **src/components/ui/Card.tsx:**
    Uses the `.placeholder-gradient-card` and `.placeholder-aspect-card` classes from globals.css (already defined in Phase 1).

    ```tsx
    interface CardProps {
      children: React.ReactNode;
      className?: string;
      hasPlaceholder?: boolean;
      placeholderVariant?: 'primary' | 'card' | 'hero';
    }

    export function Card({
      children,
      className,
      hasPlaceholder = false,
      placeholderVariant = 'card',
    }: CardProps) {
      return (
        &lt;article
          className={[
            'rounded-lg overflow-hidden bg-surface-ivory dark:bg-surface-dark-card',
            className,
          ]
            .filter(Boolean)
            .join(' ')}
        &gt;
          {hasPlaceholder && (
            &lt;div
              className={`placeholder-gradient-${placeholderVariant} placeholder-aspect-card`}
              aria-hidden="true"
            /&gt;
          )}
          &lt;div className="p-6"&gt;{children}&lt;/div&gt;
        &lt;/article&gt;
      );
    }
    ```

    ---

    **src/components/ui/Typography.tsx:**
    Enforces `font-display` (Cormorant Garamond) for headings and `font-body` (Inter) for body text. These map to the CSS custom properties defined in globals.css @theme block.

    ```tsx
    interface HeadingProps {
      level?: 1 | 2 | 3 | 4;
      children: React.ReactNode;
      className?: string;
    }

    export function Heading({ level = 2, children, className }: HeadingProps) {
      const Tag = `h${level}` as 'h1' | 'h2' | 'h3' | 'h4';
      const sizes: Record&lt;1 | 2 | 3 | 4, string&gt; = {
        1: 'text-4xl md:text-6xl font-semibold tracking-tight leading-tight',
        2: 'text-3xl md:text-4xl font-semibold tracking-tight leading-snug',
        3: 'text-2xl md:text-3xl font-medium leading-snug',
        4: 'text-xl md:text-2xl font-medium leading-normal',
      };
      return (
        &lt;Tag className={['font-display', sizes[level], className].filter(Boolean).join(' ')}&gt;
          {children}
        &lt;/Tag&gt;
      );
    }

    interface BodyTextProps {
      children: React.ReactNode;
      className?: string;
      size?: 'sm' | 'base' | 'lg';
      as?: 'p' | 'span' | 'div';
    }

    export function BodyText({ children, className, size = 'base', as: Tag = 'p' }: BodyTextProps) {
      const sizes = { sm: 'text-sm', base: 'text-base', lg: 'text-lg' };
      return (
        &lt;Tag className={['font-body', sizes[size], className].filter(Boolean).join(' ')}&gt;
          {children}
        &lt;/Tag&gt;
      );
    }
    ```

    Note: `font-display` and `font-body` are Tailwind utilities generated from the `--font-display` and `--font-body` custom properties in the globals.css @theme block (Tailwind v4 auto-generates `font-{name}` utilities from `--font-{name}` tokens).
  </action>
  <verify>Run `npx tsc --noEmit` from /Users/mohamedkhair/Coding/lumiere-beaute — zero TypeScript errors. Confirm all three files exist: `ls src/components/ui/` shows Button.tsx, Card.tsx, Typography.tsx. `grep "ps-\|pe-" src/components/ui/Button.tsx` — logical properties used (no pl-, pr-). `grep "placeholder-gradient" src/components/ui/Card.tsx` — found.</verify>
  <done>Button.tsx, Card.tsx, Typography.tsx all exist in src/components/ui/. TypeScript compiles cleanly. No physical ml-/mr-/pl-/pr- classes present in any of the three files. Card uses existing gradient placeholder classes from globals.css.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm run build` succeeds
3. `ls src/components/animations/` shows TypewriterText.tsx alongside FadeInSection.tsx and StaggerContainer.tsx (from Plan 02)
4. `ls src/components/ui/` shows Button.tsx, Card.tsx, Typography.tsx
5. `grep "aria-label\|aria-hidden" src/components/animations/TypewriterText.tsx` — both attributes found
6. `grep "ml-\|mr-\|pl-\|pr-" src/components/ui/Button.tsx src/components/ui/Card.tsx src/components/ui/Typography.tsx` — returns NO matches (logical properties only)
</verification>

<success_criteria>
- TypewriterText.tsx uses tagMap lookup (not dynamic motion[Tag]), aria-label on container, aria-hidden on spans, 40ms per character stagger
- Button.tsx: primary and ghost variants, logical spacing properties only, disabled state handled
- Card.tsx: optional gradient placeholder slot using existing .placeholder-gradient-{variant} classes
- Typography.tsx: Heading (1-4 levels) uses font-display class, BodyText uses font-body class
- TypeScript build clean across all four files
</success_criteria>

<output>
After completion, create `.planning/phases/03-shared-components/03-03-SUMMARY.md`
</output>
