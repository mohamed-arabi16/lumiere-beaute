---
phase: 03-shared-components
plan: "04"
type: execute
wave: 3
depends_on:
  - "03-02"
  - "03-03"
files_modified:
  - src/pages/HomePage.tsx
autonomous: false
requirements:
  - SC3-1
  - SC3-2
  - SC3-3
  - SC3-4
  - SC3-5

must_haves:
  truths:
    - "A temporary verification scaffold on the homepage visually demonstrates FadeInSection, StaggerContainer, TypewriterText, Button, Card, and Typography working together"
    - "Human confirms scroll-reveal animation works on both first load and after scrolling down"
    - "Human confirms TypewriterText types characters in the correct visual order for both English and Arabic"
    - "Human confirms no stagger cards are dropped at 4x CPU throttle in DevTools Performance tab"
    - "Human confirms reduced-motion system setting produces static content with no animation"
  artifacts:
    - path: "src/pages/HomePage.tsx"
      provides: "Temporary Phase 3 verification scaffold composing all new components"
      contains: "FadeInSection"
      min_lines: 40
  key_links:
    - from: "src/pages/HomePage.tsx"
      to: "src/components/animations/FadeInSection.tsx"
      via: "import and render in JSX"
      pattern: "FadeInSection"
    - from: "src/pages/HomePage.tsx"
      to: "src/components/animations/StaggerContainer.tsx"
      via: "import and render grid of 20 motion.div items"
      pattern: "StaggerContainer"
    - from: "src/pages/HomePage.tsx"
      to: "src/components/animations/TypewriterText.tsx"
      via: "import and render with English text"
      pattern: "TypewriterText"
---

<objective>
Add a temporary verification scaffold to HomePage.tsx that exercises all five Phase 3 success criteria, then verify interactively with the human.

Purpose: The scaffold proves all components work correctly in combination before Phase 4 page sections depend on them. It gets replaced entirely in Phase 4 — it is only a verification scaffold, not final content.
Output: Modified HomePage.tsx with scaffold + human verification of all 5 success criteria.
</objective>

<execution_context>
@/Users/mohamedkhair/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mohamedkhair/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/pages/HomePage.tsx
@.planning/phases/03-shared-components/3-RESEARCH.md
@.planning/phases/03-shared-components/03-02-SUMMARY.md
@.planning/phases/03-shared-components/03-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Phase 3 verification scaffold in HomePage</name>
  <files>src/pages/HomePage.tsx</files>
  <action>
    Read the current src/pages/HomePage.tsx (it is a stub from Phase 2 with a motion.div wrapper and a placeholder heading). Replace the inner content — keeping the outer motion.div with pageTransitionVariants intact — with a verification scaffold that exercises all Phase 3 components.

    The scaffold must:
    1. Render TypewriterText at the top with as="h1" and a medium-length string like "Lumiere Beaute" so the typing effect is visible
    2. Render an FadeInSection below the fold (add enough vertical padding/spacer so the user has to scroll to trigger it)
    3. Render a StaggerContainer with exactly 20 items (numbered cards) to test the 20-card performance baseline
    4. Render Button with both variants (primary and ghost) side by side
    5. Render a Card with hasPlaceholder={true}
    6. Render a Heading and BodyText from Typography

    Concrete implementation — replace the inner content of the existing motion.div:
    ```tsx
    // Add these imports at the top:
    import { FadeInSection } from '../components/animations/FadeInSection';
    import { StaggerContainer, staggerItemVariants } from '../components/animations/StaggerContainer';
    import { TypewriterText } from '../components/animations/TypewriterText';
    import { Button } from '../components/ui/Button';
    import { Card } from '../components/ui/Card';
    import { Heading, BodyText } from '../components/ui/Typography';
    import { motion } from 'motion/react';
    ```

    The scaffold body (inside the existing outer motion.div wrapper):
    ```tsx
    <main className="min-h-screen bg-surface-ivory dark:bg-surface-dark">
      {/* Hero: TypewriterText + Buttons */}
      <section className="flex flex-col items-center justify-center min-h-screen gap-8 px-6">
        <TypewriterText
          text="Lumiere Beaute"
          as="h1"
          className="font-display text-5xl md:text-7xl text-stormy-teal-950 dark:text-celadon-100 text-center"
        />
        <BodyText size="lg" className="text-jungle-teal-700 dark:text-mint-leaf-300 text-center max-w-md">
          Premium beauty &amp; academy — Istanbul
        </BodyText>
        <div className="flex gap-4 flex-wrap justify-center">
          <Button variant="primary">Book Treatment</Button>
          <Button variant="ghost">View Services</Button>
        </div>
      </section>

      {/* FadeInSection — requires scroll to trigger */}
      <section className="px-6 py-24">
        <FadeInSection className="max-w-2xl mx-auto text-center">
          <Heading level={2} className="text-stormy-teal-950 dark:text-celadon-100 mb-4">
            Phase 3 — FadeInSection
          </Heading>
          <BodyText className="text-jungle-teal-700 dark:text-mint-leaf-400">
            This section fades and slides up into view when scrolled to.
            It will not re-animate on scroll-back (viewport once:true).
          </BodyText>
        </FadeInSection>
      </section>

      {/* Card with gradient placeholder */}
      <section className="px-6 py-12">
        <FadeInSection delay={0.1} className="max-w-sm mx-auto">
          <Card hasPlaceholder={true}>
            <Heading level={3} className="text-stormy-teal-950 dark:text-celadon-100 mb-2">
              Treatment Card
            </Heading>
            <BodyText size="sm" className="text-jungle-teal-700 dark:text-mint-leaf-400">
              Card with gradient placeholder — ready for Phase 4 content.
            </BodyText>
          </Card>
        </FadeInSection>
      </section>

      {/* StaggerContainer — 20 items performance test */}
      <section className="px-6 py-24">
        <FadeInSection className="text-center mb-12">
          <Heading level={2} className="text-stormy-teal-950 dark:text-celadon-100">
            Phase 3 — StaggerContainer (20 items)
          </Heading>
        </FadeInSection>
        <StaggerContainer className="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-5 gap-4 max-w-4xl mx-auto">
          {Array.from({ length: 20 }, (_, i) => (
            <motion.div key={i} variants={staggerItemVariants}>
              <div className="bg-surface-dark-card dark:bg-jungle-teal-700 rounded-lg p-4 text-center">
                <BodyText size="sm" className="text-celadon-100 font-medium">
                  Item {i + 1}
                </BodyText>
              </div>
            </motion.div>
          ))}
        </StaggerContainer>
      </section>

      <div className="h-32" /> {/* bottom spacer */}
    </main>
    ```

    Keep the outer motion.div from the Phase 2 stub (the one with pageTransitionVariants) — only replace the inner content.

    Note: This scaffold is temporary — Phase 4 will replace it entirely with real homepage sections. Add a comment at the top of the file: `// PHASE 3 VERIFICATION SCAFFOLD — replaced entirely in Phase 4`
  </action>
  <verify>Run `npm run dev` from /Users/mohamedkhair/Coding/lumiere-beaute — dev server starts without errors. Visit http://localhost:5173 — no console errors, TypewriterText animates, buttons visible. Run `npx tsc --noEmit` — zero TypeScript errors.</verify>
  <done>HomePage.tsx renders the verification scaffold with all 6 component types. Dev server loads the page at localhost:5173 with no console errors. TypewriterText animation is visible immediately. Scroll reveals FadeInSection content. StaggerContainer grid of 20 items is present below the fold.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human verification of all 5 Phase 3 success criteria</name>
  <action>
    Pause for human verification. All Phase 3 components are now rendered in the verification scaffold. The human must confirm each of the 5 success criteria by following the steps in how-to-verify.
  </action>
  <verify>Human types "approved" after confirming all 5 success criteria.</verify>
  <done>Human has confirmed: (1) FadeInSection stays visible on scroll-back, (2) TypewriterText types in correct RTL/LTR order, (3) page transitions still RTL-correct, (4) prefers-reduced-motion shows static content, (5) 20-card stagger at 4x CPU throttle has no dropped frames.</done>
  <what-built>
    A Phase 3 verification scaffold on the homepage demonstrating all new components:
    - TypewriterText: types "Lumiere Beaute" character by character on page load
    - FadeInSection: fades + slides up content when scrolled into viewport (once only)
    - StaggerContainer: 20 numbered items cascade in from top when grid scrolls into view
    - Button: "Book Treatment" (primary) and "View Services" (ghost) variants
    - Card: content card with gradient placeholder image slot
    - Typography: Heading and BodyText enforcing brand fonts
    - MotionConfig: global prefers-reduced-motion guard in AppProviders
  </what-built>
  <how-to-verify>
    Run `npm run dev` and visit http://localhost:5173 — then verify each success criterion:

    **SC3-1: Scroll-reveal (FadeInSection)**
    1. Load the page — the hero content (TypewriterText + buttons) should be visible immediately
    2. Scroll down — the "Phase 3 — FadeInSection" section should fade and slide upward into view
    3. Scroll back UP past the FadeInSection — it should STAY visible (not re-animate). If it disappears and re-animates, viewport once:true is missing.

    **SC3-2: TypewriterText**
    4. Reload the page — "Lumiere Beaute" should type itself character by character (expect ~600ms total at 40ms/char)
    5. Switch language to Arabic (ع button in navbar) — the Arabic version of the page should type Arabic characters in correct visual RTL order
    6. Reload in Arabic — characters appear right-to-left as expected

    **SC3-3: Horizontal animation direction (RTL)**
    7. Switch to Arabic — confirm page transition animation slides from the correct side (this was Phase 2 functionality; confirm still working with MotionConfig added)

    **SC3-4: prefers-reduced-motion**
    8. In macOS System Preferences → Accessibility → Display, enable "Reduce motion"
    9. Reload the page — TypewriterText, FadeInSection, StaggerContainer should all show their final state immediately with no animation
    10. Re-disable "Reduce motion" setting after verification

    **SC3-5: 20-card stagger performance at 4x CPU throttle**
    11. Open Chrome DevTools → Performance tab → CPU: 4x slowdown
    12. Scroll to the "StaggerContainer (20 items)" section
    13. All 20 items should animate in without dropped frames (no jank, no stutter)
    14. The last item should finish within ~2 seconds of the first (0.06s × 20 = 1.2s stagger spread)

    Expected outcomes: All 5 criteria pass with no issues.
  </how-to-verify>
  <resume-signal>Type "approved" if all 5 criteria pass, or describe which criteria failed and what you observed.</resume-signal>
</task>

</tasks>

<verification>
All 5 Phase 3 success criteria confirmed by human:
1. FadeInSection reveals on scroll with no re-animation on scroll-back
2. TypewriterText types in correct reading direction for both LTR and RTL
3. Page transition horizontal direction still correct for Arabic (Phase 2 preserved)
4. prefers-reduced-motion produces static content
5. 20-card stagger at 4x CPU throttle shows no dropped frames
</verification>

<success_criteria>
- TypewriterText "Lumiere Beaute" types correctly in English (left-to-right character appearance)
- FadeInSection triggers once on scroll, stays visible on scroll-back
- StaggerContainer 20 items complete stagger within ~2 seconds total
- prefers-reduced-motion: all animations skip to final state
- Human has typed "approved" confirming all 5 Phase 3 success criteria
</success_criteria>

<output>
After completion, create `.planning/phases/03-shared-components/03-04-SUMMARY.md`
</output>
