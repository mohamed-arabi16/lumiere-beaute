---
phase: 05-academy-and-contact
plan: "03"
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/components/sections/ContactFormSection.tsx
  - src/components/sections/ContactInfoSection.tsx
autonomous: true
requirements: [CNTC-01, CNTC-02, CNTC-03]
user_setup:
  - service: emailjs
    why: "Contact form sends inquiries via EmailJS — credentials required for the form to deliver emails"
    env_vars:
      - name: VITE_EMAILJS_SERVICE_ID
        source: "EmailJS Dashboard → Email Services → your service → Service ID"
      - name: VITE_EMAILJS_TEMPLATE_ID
        source: "EmailJS Dashboard → Email Templates → your template → Template ID"
      - name: VITE_EMAILJS_PUBLIC_KEY
        source: "EmailJS Dashboard → Account → General → Public Key"
    dashboard_config:
      - task: "Create an Email Template with variables {{from_name}}, {{from_email}}, {{service}}, {{message}}"
        location: "EmailJS Dashboard → Email Templates → Create New Template"
  - service: whatsapp
    why: "WhatsApp CTA button requires the business phone number in E.164 format (digits only, no + prefix)"
    env_vars:
      - name: VITE_WHATSAPP_NUMBER
        source: "Business WhatsApp number — Turkey country code 90 + local number, no + or spaces. Example: 905XXXXXXXXX"

must_haves:
  truths:
    - "Contact form renders 4 fields: name (text), email (email), service (select dropdown), message (textarea)"
    - "Submitting the form with valid data calls emailjs.send() and shows a success confirmation message"
    - "Form fields clear after successful submission"
    - "A WhatsApp CTA button opens wa.me with a pre-filled message in the current language (new tab)"
    - "Contact info section displays address, phone, email, and business hours"
  artifacts:
    - path: "src/components/sections/ContactFormSection.tsx"
      provides: "EmailJS-wired contact form with loading/success/error state machine"
      exports: ["ContactFormSection"]
      min_lines: 80
    - path: "src/components/sections/ContactInfoSection.tsx"
      provides: "Static info card: address, hours, phone, email, WhatsApp CTA"
      exports: ["ContactInfoSection"]
      min_lines: 40
  key_links:
    - from: "src/components/sections/ContactFormSection.tsx"
      to: "@emailjs/browser"
      via: "emailjs.send() with VITE_ env vars"
      pattern: "emailjs\\.send"
    - from: "src/components/sections/ContactInfoSection.tsx"
      to: "src/i18n/locales/en/common.json"
      via: "t('contact.location.*') locale keys"
      pattern: "contact\\.location"
    - from: "src/components/sections/ContactFormSection.tsx"
      to: "src/components/ui/Button.tsx"
      via: "Button as='a' for WhatsApp CTA, Button type='submit' for form submit"
      pattern: "whatsapp_cta"
---

<objective>
Build the two Contact page sections: ContactFormSection (EmailJS-wired 4-field form with loading/success/error states + WhatsApp CTA) and ContactInfoSection (static location info card).

Purpose: Delivers CNTC-01 (EmailJS form submission), CNTC-02 (WhatsApp CTA button), and CNTC-03 (location info) as standalone section components ready for ContactPage composition in Plan 05-04.
Output: src/components/sections/ContactFormSection.tsx and src/components/sections/ContactInfoSection.tsx.
</objective>

<execution_context>
@/Users/mohamedkhair/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mohamedkhair/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-academy-and-contact/05-RESEARCH.md
@.planning/phases/05-academy-and-contact/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @emailjs/browser and build ContactFormSection with EmailJS integration</name>
  <files>src/components/sections/ContactFormSection.tsx</files>
  <action>
    First, install the EmailJS browser SDK:
    ```bash
    npm install @emailjs/browser
    ```

    Create `src/components/sections/ContactFormSection.tsx`:

    ```typescript
    import { useState } from 'react';
    import { useTranslation } from 'react-i18next';
    import emailjs, { type EmailJSResponseStatus } from '@emailjs/browser';
    import { FadeInSection } from '../animations/FadeInSection';
    import { Heading, BodyText } from '../ui/Typography';
    import { Button } from '../ui/Button';

    /**
     * ContactFormSection — EmailJS-wired 4-field contact form.
     *
     * State machine: idle | loading | success | error
     * - idle: form visible, submit button enabled
     * - loading: submit button shows "Sending..." text, disabled
     * - success: form hidden, success confirmation shown, fields reset
     * - error: form still visible, error message shown below submit button
     *
     * EmailJS template variable mapping (must match EmailJS dashboard template):
     * - {{from_name}}  ← values.name
     * - {{from_email}} ← values.email
     * - {{service}}    ← values.service
     * - {{message}}    ← values.message
     *
     * Env vars required: VITE_EMAILJS_SERVICE_ID, VITE_EMAILJS_TEMPLATE_ID, VITE_EMAILJS_PUBLIC_KEY
     * VITE_ prefix is mandatory — Vite strips non-VITE_ vars from client bundle.
     *
     * WhatsApp CTA uses Button as="a" with target="_blank" rel="noopener noreferrer".
     * Phone from VITE_WHATSAPP_NUMBER env var (digits only, no + prefix).
     */

    type FormStatus = 'idle' | 'loading' | 'success' | 'error';

    interface FormValues {
      name: string;
      email: string;
      service: string;
      message: string;
    }

    function buildWhatsAppURL(phone: string, message: string): string {
      return `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
    }

    const inputBase =
      'w-full rounded-sm border border-seagrass-300 bg-white px-4 py-2.5 font-body text-sm text-stormy-teal-950 placeholder:text-seagrass-400 focus:border-seagrass-500 focus:outline-none focus:ring-2 focus:ring-seagrass-500/30 dark:border-seagrass-700 dark:bg-surface-dark-card dark:text-celadon-100 dark:placeholder:text-seagrass-500 dark:focus:border-seagrass-400 transition-colors';

    export function ContactFormSection() {
      const { t } = useTranslation('common');
      const [values, setValues] = useState<FormValues>({
        name: '',
        email: '',
        service: '',
        message: '',
      });
      const [status, setStatus] = useState<FormStatus>('idle');
      const [errorMessage, setErrorMessage] = useState<string>('');

      const phone = import.meta.env.VITE_WHATSAPP_NUMBER ?? '905XXXXXXXXX';
      const whatsappHref = buildWhatsAppURL(phone, t('contact.whatsapp_message'));
      const serviceOptions = t('contact.form.service_options', { returnObjects: true }) as string[];

      const handleChange = (
        e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>
      ) => {
        setValues((prev) => ({ ...prev, [e.target.name]: e.target.value }));
      };

      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        if (status === 'loading') return;
        setStatus('loading');
        setErrorMessage('');

        try {
          await emailjs.send(
            import.meta.env.VITE_EMAILJS_SERVICE_ID,
            import.meta.env.VITE_EMAILJS_TEMPLATE_ID,
            {
              from_name: values.name,
              from_email: values.email,
              service: values.service,
              message: values.message,
            },
            { publicKey: import.meta.env.VITE_EMAILJS_PUBLIC_KEY }
          );
          setStatus('success');
          setValues({ name: '', email: '', service: '', message: '' });
        } catch (err) {
          if (err instanceof EmailJSResponseStatus) {
            setErrorMessage(err.text);
          } else {
            setErrorMessage(t('contact.form.error_generic'));
          }
          setStatus('error');
        }
      };

      return (
        <FadeInSection className="py-16 px-6">
          <div className="max-w-xl mx-auto">
            <Heading level={2} className="mb-8 text-center">
              {t('contact.form.heading')}
            </Heading>

            {/* WhatsApp CTA above form */}
            <div className="mb-8 flex justify-center">
              <Button
                as="a"
                variant="primary"
                href={whatsappHref}
                target="_blank"
                rel="noopener noreferrer"
              >
                {t('contact.whatsapp_cta')}
              </Button>
            </div>

            {status === 'success' ? (
              <div className="rounded-sm border border-seagrass-400 bg-seagrass-50 p-8 text-center dark:border-seagrass-600 dark:bg-seagrass-900/20">
                <Heading level={3}>{t('contact.form.success_heading')}</Heading>
                <BodyText className="mt-2 text-jungle-teal-700 dark:text-mint-leaf-400">
                  {t('contact.form.success_body')}
                </BodyText>
              </div>
            ) : (
              <form onSubmit={handleSubmit} noValidate className="space-y-5">
                <div>
                  <label htmlFor="name" className="mb-1.5 block font-body text-sm font-medium text-stormy-teal-950 dark:text-celadon-100">
                    {t('contact.form.name_label')}
                  </label>
                  <input
                    id="name"
                    name="name"
                    type="text"
                    required
                    value={values.name}
                    onChange={handleChange}
                    className={inputBase}
                  />
                </div>

                <div>
                  <label htmlFor="email" className="mb-1.5 block font-body text-sm font-medium text-stormy-teal-950 dark:text-celadon-100">
                    {t('contact.form.email_label')}
                  </label>
                  <input
                    id="email"
                    name="email"
                    type="email"
                    required
                    value={values.email}
                    onChange={handleChange}
                    className={inputBase}
                  />
                </div>

                <div>
                  <label htmlFor="service" className="mb-1.5 block font-body text-sm font-medium text-stormy-teal-950 dark:text-celadon-100">
                    {t('contact.form.service_label')}
                  </label>
                  <select
                    id="service"
                    name="service"
                    required
                    value={values.service}
                    onChange={handleChange}
                    className={inputBase}
                  >
                    <option value="" disabled>—</option>
                    {serviceOptions.map((opt) => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                </div>

                <div>
                  <label htmlFor="message" className="mb-1.5 block font-body text-sm font-medium text-stormy-teal-950 dark:text-celadon-100">
                    {t('contact.form.message_label')}
                  </label>
                  <textarea
                    id="message"
                    name="message"
                    rows={5}
                    required
                    value={values.message}
                    onChange={handleChange}
                    className={inputBase}
                  />
                </div>

                {status === 'error' && errorMessage && (
                  <BodyText size="sm" className="text-red-600 dark:text-red-400">
                    {errorMessage}
                  </BodyText>
                )}

                <Button
                  variant="primary"
                  type="submit"
                  disabled={status === 'loading'}
                  className="w-full justify-center"
                >
                  {status === 'loading' ? t('contact.form.sending') : t('contact.form.submit_cta')}
                </Button>
              </form>
            )}
          </div>
        </FadeInSection>
      );
    }
    ```

    Color tokens used: all from @theme block (seagrass-*, stormy-teal-*, celadon-*, jungle-teal-*, mint-leaf-*, surface-dark-card). No physical ml-/mr-/pl-/pr- classes — all spacing via px-/py-/ps-/pe- (logical or non-directional).
  </action>
  <verify>Run `npx tsc --noEmit` — zero errors. Verify @emailjs/browser appears in package.json dependencies. Confirm ContactFormSection.tsx imports emailjs and EmailJSResponseStatus, has handleSubmit calling emailjs.send(), has status state machine with four states, clears values on success, and WhatsApp CTA button exists with target="_blank".</verify>
  <done>@emailjs/browser installed in package.json. ContactFormSection.tsx exports ContactFormSection, renders 4-field form (name, email, service select with 7 options, message textarea), calls emailjs.send() on submit, resets form on success, shows error message on failure, includes WhatsApp CTA button. Zero TypeScript errors.</done>
</task>

<task type="auto">
  <name>Task 2: Build ContactInfoSection with address, hours, and contact details</name>
  <files>src/components/sections/ContactInfoSection.tsx</files>
  <action>
    Create `src/components/sections/ContactInfoSection.tsx`. Renders static location info from locale JSON — address, phone, email, business hours table. Uses FadeInSection for scroll reveal. Model on the Card + Heading + BodyText pattern from Phase 3/4.

    ```typescript
    import { useTranslation } from 'react-i18next';
    import { FadeInSection } from '../animations/FadeInSection';
    import { Card } from '../ui/Card';
    import { Heading, BodyText } from '../ui/Typography';

    /**
     * ContactInfoSection — Static contact details and business hours.
     *
     * Renders address, phone, email, and a business hours list from
     * contact.location locale keys. All content externalized — zero
     * hardcoded strings.
     *
     * Business hours rendered as a definition list for semantic HTML.
     * Each day/hours pair from contact.location.hours array.
     */

    interface HoursEntry {
      days: string;
      hours: string;
    }

    export function ContactInfoSection() {
      const { t } = useTranslation('common');
      const hours = t('contact.location.hours', { returnObjects: true }) as HoursEntry[];

      return (
        <FadeInSection className="py-16 px-6 bg-surface-ivory dark:bg-surface-dark">
          <div className="max-w-xl mx-auto">
            <Heading level={2} className="mb-8 text-center">
              {t('contact.location.heading')}
            </Heading>

            <Card className="space-y-6">
              {/* Address */}
              <div>
                <BodyText size="sm" className="font-medium text-stormy-teal-950 dark:text-celadon-100">
                  {t('contact.location.address')}
                </BodyText>
              </div>

              {/* Phone + Email */}
              <div className="space-y-1">
                <BodyText size="sm" className="text-seagrass-600 dark:text-seagrass-400">
                  {t('contact.location.phone')}
                </BodyText>
                <BodyText size="sm" className="text-seagrass-600 dark:text-seagrass-400">
                  {t('contact.location.email')}
                </BodyText>
              </div>

              {/* Business Hours */}
              <div>
                <BodyText size="sm" className="mb-3 font-medium text-stormy-teal-950 dark:text-celadon-100">
                  {t('contact.location.hours_heading')}
                </BodyText>
                <dl className="space-y-2">
                  {hours.map((entry) => (
                    <div key={entry.days} className="flex justify-between gap-4">
                      <dt className="font-body text-sm text-jungle-teal-700 dark:text-mint-leaf-400">
                        {entry.days}
                      </dt>
                      <dd className="font-body text-sm text-stormy-teal-950 dark:text-celadon-100">
                        {entry.hours}
                      </dd>
                    </div>
                  ))}
                </dl>
              </div>
            </Card>
          </div>
        </FadeInSection>
      );
    }
    ```

    IMPORTANT: `bg-surface-ivory` and `bg-surface-dark` are valid semantic surface tokens defined in the @theme block (confirmed in Phase 4 audit). Use them for the section background to maintain the editorial contrast rhythm (same pattern as TestimonialsSection from 04-03).

    No inline spacing with `ml-` / `mr-` — only `gap-`, `space-y-`, and logical properties. `justify-between` on the flex dl/dd row is not inline-axis spacing, it's a flex distribution — this is correct per the project convention.
  </action>
  <verify>Run `npx tsc --noEmit` — zero errors. ContactInfoSection.tsx exists. Verify it imports HoursEntry type inline (not from content.ts — this is a local shape), maps over contact.location.hours array, renders days and hours pairs. No raw string literals hardcoded for address/phone/email.</verify>
  <done>ContactInfoSection.tsx exports ContactInfoSection, uses t('contact.location.*') keys for all content (zero hardcoded strings), renders address, phone, email, and business hours from locale JSON. Zero TypeScript errors.</done>
</task>

</tasks>

<verification>
Run `npx tsc --noEmit` — zero errors.
Confirm @emailjs/browser in package.json.
Verify ContactFormSection.tsx: emailjs.send() called in handleSubmit, status state machine (idle/loading/success/error), form values reset on success, WhatsApp CTA button with target="_blank".
Verify ContactInfoSection.tsx: all content via t() calls, hours array mapped, semantic HTML (dl/dt/dd).
</verification>

<success_criteria>
Both contact sections built and type-safe. ContactFormSection wires to EmailJS via controlled state + send() — delivers CNTC-01 and CNTC-02. ContactInfoSection renders location info from locale JSON — delivers CNTC-03. Ready for ContactPage composition in Plan 05-04.
</success_criteria>

<output>
After completion, create `.planning/phases/05-academy-and-contact/05-03-SUMMARY.md`
</output>
